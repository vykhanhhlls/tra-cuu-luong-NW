<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <title>Tra cứu lương OneFit</title>
  <style>
    body {font-family: Arial, sans-serif; max-width: 650px; margin: 40px auto; padding: 20px; background: #f8f9fa;}
    table {width: 100%; border-collapse: collapse; background: white; box-shadow: 0 4px 20px rgba(0,0,0,0.1); border-radius: 8px; overflow: hidden;}
    th, td {padding: 16px; text-align: left;}
    th {background: #1a73e8; color: white; font-weight: normal;}
    input {width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 16px; box-sizing: border-box;}
    a {color: #1a73e8; word-break: break-all; font-size: 17px; font-weight: 500;}
    h1 {text-align: center; color: #333;}
    .note {font-size: 14px; color: #666; text-align: center; margin-top: 20px;}
  </style>
</head>
<body>
  <h1>Tra cứu lương OneFit</h1>
  <table>
    <tr><th>Mã thẻ</th>        <td><input type="text" id="maThe" placeholder="Ví dụ: V3111318" oninput="taoLink()"></td></tr>
    <tr><th>Tháng (YYYYMM)</th><td><input type="text" id="thang" value="202511" oninput="taoLink()"></td></tr>
    <tr><th>Họ và tên</th>     <td><input type="text" id="hoTen" placeholder="Không bắt buộc"></td></tr>
    <tr><th>Link báo cáo</th>  <td id="ketQua" style="color:#d32f2f;"></td></tr>
  </table>
  <div class="note">Click vào link để mở báo cáo lương ngay lập tức</div>

<script>
function taoLink() {
  const ma = document.getElementById("maThe").value.trim().toUpperCase();
  const thang = document.getElementById("thang").value.trim();

  if (ma && thang && thang.length === 6 && /^\d{6}$/.test(thang)) {
    // Tạo chuỗi số ngẫu nhiên giống Excel (13 chữ số)
    const timestamp = new Date().getTime(); // 1757...
    const randomNum = Math.floor(Math.random() * 10000);
    const fakeCache = timestamp.toString().slice(0, 10) + randomNum; // giống 1757736589833

    const link = `https://esalary.one-fit.com/VN/Program/QueryReport/AjaxRequest.aspx?key=getsalarybyid&uid=${ma}&_=${fakeCache}`;
    
    document.getElementById("ketQua").innerHTML = 
      `<a href="${link}" target="_blank">${link}</a>`;
  } else if (ma && thang) {
    document.getElementById("ketQua").innerText = "⚠️ Tháng phải đúng định dạng YYYYMM (ví dụ: 202511)";
  } else {
    document.getElementById("ketQua").innerText = "";
  }
}

// Tự động sinh link khi mở trang nếu đã có dữ liệu
window.onload = taoLink;
</script>
</body>
</html>
